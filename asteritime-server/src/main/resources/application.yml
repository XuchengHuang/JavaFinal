spring:
  application:
    name: asteritime-server
  
  datasource:
    url: jdbc:mysql://localhost:3306/asteritime?useSSL=false&serverTimezone=UTC&characterEncoding=UTF-8&allowPublicKeyRetrieval=true
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:}
    driver-class-name: com.mysql.cj.jdbc.Driver
    # HikariCP connection pool configuration (supports multi-threaded concurrency)
    hikari:
      # Minimum idle connections
      minimum-idle: 5
      # Maximum pool size (adjust based on server performance, recommended: CPU cores * 2 + disk count)
      maximum-pool-size: 20
      # Connection timeout (milliseconds)
      connection-timeout: 30000
      # Maximum idle time (milliseconds), unused connections will be released after this time
      idle-timeout: 600000
      # Maximum connection lifetime (milliseconds), connections exceeding this will be closed and recreated
      max-lifetime: 1800000
      # Connection pool name (for monitoring)
      pool-name: AsteriTimeHikariCP
      # Auto-commit (default true, recommended to keep true)
      auto-commit: true
      # Connection leak detection (milliseconds), 0 means disabled
      leak-detection-threshold: 60000
  
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQL8Dialect
        format_sql: true
        # Transaction isolation level: READ_COMMITTED (prevents dirty reads)
        # Options: READ_UNCOMMITTED, READ_COMMITTED, REPEATABLE_READ, SERIALIZABLE
        connection:
          isolation: 2  # 2 = READ_COMMITTED
        # Enable second-level cache (optional, for performance improvement)
        # cache:
        #   use_second_level_cache: true
        #   use_query_cache: true

server:
  port: 8080
  servlet:
    context-path: /api
    # Tomcat thread pool configuration (supports multi-threaded connection handling)
    threads:
      # Maximum worker threads (threads handling requests)
      max: 200
      # Minimum worker threads
      min-spare: 10
    # Tomcat connector configuration
    tomcat:
      # Maximum connections (concurrent connections)
      max-connections: 10000
      # Accept count (threads accepting connections)
      accept-count: 100
      # Connection timeout (milliseconds)
      connection-timeout: 20000
      # Enable compression
      compression: on
      # Compressible MIME types
      compressible-mime-types: text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json

logging:
  level:
    com.asteritime: DEBUG
    org.springframework.web: INFO

# JWT configuration (read from environment variables, default values for development only)
jwt:
  secret: ${JWT_SECRET:AsteriTimeSecretKeyForJWTTokenGeneration2025ThisShouldBeLongEnough}
  expiration: ${JWT_EXPIRATION:604800000}  # 7 days (milliseconds)


